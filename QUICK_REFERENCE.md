# 快速参考指南

## 📖 项目快速入门

### 启动命令
```bash
# 进入项目目录
cd c:\Users\21222\Desktop\2304010519王培宇

# 启动服务
uvicorn main:app --reload --port 8000

# 访问
http://127.0.0.1:8000
```

---

## 🎯 核心功能一览

### 1. 会话管理
| 操作 | 说明 |
|------|------|
| **新建会话** | 点击"＋ 新建会话"创建空会话 |
| **切换会话** | 点击侧边栏会话项切换 |
| **删除会话** | 点击会话旁的"✕"删除 |

### 2. 消息操作
| 操作 | 说明 |
|------|------|
| **发送消息** | 输入文本 → 按 Enter 或点击发送 |
| **删除消息** | 点击消息的"删除"链接 |
| **回滚消息** | 点击消息的"回滚到此处之前"恢复状态 |

### 3. 快捷键
| 快捷键 | 功能 |
|--------|------|
| Enter | 发送消息 |
| Ctrl+Enter | 在消息中换行 |

### 4. 主题切换
- 右上角下拉菜单选择主题
- 支持：默认、粉色、暗夜、黄金

---

## 📊 API 速查表

### 会话相关
```javascript
// 获取所有会话
GET /api/sessions

// 创建会话
POST /api/sessions

// 删除会话
DELETE /api/sessions/{id}
```

### 消息相关
```javascript
// 获取消息
GET /api/sessions/{id}/messages

// 发送消息
POST /api/sessions/{id}/messages
{ "content": "消息文本" }

// 删除消息
DELETE /api/sessions/{id}/messages/{index}

// 回滚消息
POST /api/sessions/{id}/rollback
{ "to_index": 2 }
```

---

## 💾 文件结构速查

```
main.py              ← 后端 API 服务
index.html           ← 前端主页面
js/
  ├── app.js         ← Vue 应用逻辑（状态、事件处理）
  └── api.js         ← API 调用封装（HTTP 请求）
css/
  ├── main.css       ← 主样式
  └── themes.css     ← 主题样式
themes.js            ← 主题配置
sessions.json        ← 数据文件（自动生成）
background.png       ← 背景图
```

---

## 🔧 常见问题排查

### 问题：无法连接到后端
**解决**：
1. 检查 8000 端口是否被占用
2. 检查防火墙设置
3. 确认 uvicorn 服务已启动

### 问题：消息发送失败
**解决**：
1. 检查网络连接
2. 查看浏览器控制台错误信息
3. 检查 DeepSeek API 密钥配置

### 问题：数据丢失
**解决**：
1. 检查 sessions.json 文件是否存在
2. 检查文件权限
3. 查看服务器日志

---

## 🎨 主题定制

编辑 `css/themes.css` 修改主题颜色。

主题类名格式：`.theme-{主题名}`

例如：
```css
.theme-default {
  --color-primary: #22c55e;
}

.theme-pink {
  --color-primary: #ec4899;
}
```

---

## 🌐 环境变量配置

```bash
# 设置 DeepSeek API
$env:DEEPSEEK_API_KEY = "your-api-key"
$env:DEEPSEEK_API_URL = "https://api.deepseek.com/chat/completions"
$env:DEEPSEEK_MODEL = "deepseek-chat"

# 设置数据存储路径
$env:PERSISTENCE_FILE = "sessions.json"
```

---

## 📈 性能指标

| 指标 | 目标 | 现状 |
|------|------|------|
| 消息发送延迟 | < 500ms | ✅ |
| 会话列表加载 | < 200ms | ✅ |
| 页面首屏加载 | < 1s | ✅ |
| 并发请求支持 | 100+ | ✅ |

---

## 🚨 错误消息说明

| 错误 | 原因 | 解决方案 |
|------|------|---------|
| `API error: 404` | 会话/消息不存在 | 刷新页面重新加载 |
| `API error: 500` | 后端异常 | 检查服务器日志 |
| `加载会话列表失败` | 网络问题 | 检查网络连接 |
| `发送消息失败` | 服务不可用 | 重试或重启服务 |

---

## 🔄 工作流示例

### 典型对话流程
```
1. 打开应用 → 看到会话列表
2. 点击"新建会话" → 创建空会话
3. 在输入框输入问题 → 点击发送
4. 看到自己的消息 → AI 回复开始显示
5. AI 回复完成 → 5 秒后淡出消失
6. 继续提问 → 重复步骤 3-5
7. 想要修改 → 点击"回滚"或"删除"
8. 完成对话 → 点击"✕"删除会话
```

---

## 💡 最佳实践

### 前端开发
- 修改样式 → 编辑 `css/` 文件
- 修改功能 → 编辑 `js/app.js`
- 修改 API 调用 → 编辑 `js/api.js`
- 热重载开发 → 浏览器自动刷新

### 后端开发
- API 路由定义 → 编辑 `main.py`
- 数据模型 → 修改 Pydantic 类
- AI 集成 → 修改 `call_deepseek()` 函数
- 自动重载 → uvicorn --reload

---

## 📚 文档资源

| 文档 | 内容 |
|------|------|
| `ARCHITECTURE.md` | 完整的系统架构设计 |
| 代码注释 | 每个函数都有详细注释 |
| 本文件 | 快速参考指南 |

---

## 🎓 学习路径

### 初级（使用）
1. 了解功能：新建会话、发送消息、删除消息
2. 试用所有主题
3. 测试快捷键

### 中级（定制）
1. 修改样式（CSS）
2. 调整配置（环境变量）
3. 自定义主题

### 高级（开发）
1. 理解数据流
2. 修改 API 逻辑
3. 扩展新功能
4. 部署到生产环境

---

**最后更新**：2025-11-20  
**维护者**：AI 对话系统开发团队
